import{d as N,i as $,j as p,e as A,w as _,o as r,c as i,F as O,r as B,b as a,k as C,l as F,n as M,t as l,m as v,p as c,s as J,_ as Q,h as X,g as K}from"./index-GAfbUcLQ.js";const Y={key:0,class:"main"},Z={class:"card"},ee={class:"wrapper"},te={class:"dateDisplay"},ae={class:"eventDay"},se={class:"eventMonth"},ne={class:"eventTime"},oe={class:"eventTimeOfDay"},re={class:"dateDisplay"},ie={class:"eventDay"},le={class:"eventMonth"},ce={class:"eventTime"},de={class:"eventTimeOfDay"},ue={key:0},ge={key:0},me=["src"],he=["innerHTML"],ve={key:3},pe={key:1,class:"empty"},w="-",ye=N({__name:"GoogleCalendar",props:{calendarID:{type:Array,required:!1}},setup(G){F(s=>({"337c8fcc":g.value}));const f=$("branch",p("General")),g=A(()=>"var("+c[f.value].color+")"),m=G,n=p(null),o=p();function E(){for(const s in m.calendarID){const t=new XMLHttpRequest;t.onreadystatechange=function(){this.readyState==4&&this.status==200&&(n.value?n.value=n.value.concat(JSON.parse(this.responseText).items):n.value=JSON.parse(this.responseText).items)},t.open("GET",`https://www.googleapis.com/calendar/v3/calendars/${m.calendarID[s]}/events?key=AIzaSyC7fs2QT_Hb9Q3Tn5_7bhLcOISwqsgLyg4&maxResults=16&orderBy=startTime&singleEvents=true&timeMin=${new Date().toISOString()}`,!0),t.send()}}const u=p([]);return _(()=>m.calendarID,()=>{n.value=null,E()},{immediate:!0}),_(n,()=>{u.value=[];const s=n.value;for(const t in s){const e=s[t].summary;if(e.startsWith("?")&&!J.Tools.display)continue;const y=s[t].location,d=new Date(s[t].start.dateTime),h=new Date(s[t].end.dateTime),D=d.getDate(),U=String(D).length==1?"0"+String(D):D,V=String(d).split(" ")[1].toUpperCase(),T=d.toLocaleTimeString(navigator.language,{hour:"2-digit",minute:"2-digit"}).split(" "),j=T[0],H=T.length>1?T[1]:"",b=h.getDate(),W=String(b).length==1?"0"+String(b):b,q=String(h).split(" ")[1].toUpperCase(),S=h.toLocaleTimeString(navigator.language,{hour:"2-digit",minute:"2-digit"}).split(" "),z=S[0],P=S.length>1?S[1]:"";let I=null;Object.keys(s[t]).includes("attachments")&&(I="https://drive.google.com/thumbnail?id="+s[t].attachments[0].fileId);const R=s[t].description;let x="--octagon-general",L="General";for(const k in c)c[k].GoogleCalendar==s[t].organizer.email&&(x=c[k].color,L=k);u.value.push({start:{day:U,month:V,time:j,timeOfDay:H,startDateTime:d},end:{day:W,month:q,time:z,timeOfDay:P},summary:e,location:y,imageUrl:I,description:R,color:x,branch:L})}u.value.length&&u.value.sort((t,e)=>{const y=new Date(t.start.startDateTime),d=new Date(e.start.startDateTime);return y-d})}),_(o,()=>{for(const s in o.value)for(const t in o.value[s].getElementsByTagName("a"))try{o.value[s].getElementsByTagName("a")[t].setAttribute("target","_blank")}catch{continue}}),(s,t)=>(r(),i("main",null,[u.value.length?(r(),i("div",Y,[(r(!0),i(O,null,B(u.value,(e,y)=>(r(),i("div",Z,[a("div",ee,[a("div",{class:"branch",style:M({"background-color":"var("+e.color+")"})},l(e.branch),5),a("div",{class:"timeDisplay",style:M({"background-color":"var("+e.color+")"})},[a("div",te,[a("div",ae,l(e.start.day),1),a("div",se,l(e.start.month),1),a("div",ne,l(e.start.time),1),a("div",oe,l(e.start.timeOfDay),1)]),t[0]||(t[0]=a("div",{class:"dateDisplay"},"TILL",-1)),a("div",re,[a("div",ie,l(e.end.day),1),a("div",le,l(e.end.month),1),a("div",ce,l(e.end.time),1),a("div",de,l(e.end.timeOfDay),1)])],4)]),a("div",{ref_for:!0,ref_key:"content",ref:o,class:"content",style:{padding:"15px"}},[String(e.summary).startsWith(w)?v("",!0):(r(),i("div",ue,[(r(!0),i(O,null,B(e.summary.split("\\n"),(d,h)=>(r(),i("b",null,[C(l(d),1),h!=e.summary.split("\\n").length?(r(),i("br",ge)):v("",!0)]))),256))])),e.imageUrl?(r(),i("img",{key:1,class:"googleDriveImage",src:e.imageUrl},null,8,me)):v("",!0),e.description&&!String(e.description).startsWith(w)?(r(),i("div",{key:2,innerHTML:e.description,class:"googleCalendarDescription"},null,8,he)):v("",!0),e.location&&!String(e.location).startsWith(w)?(r(),i("div",ve,"Location: "+l(e.location),1)):v("",!0)],512)]))),256))])):(r(),i("div",pe,t[1]||(t[1]=[a("h1",null,[C("Pretty empty right now."),a("br"),C("Maybe next time?")],-1)])))]))}}),_e=Q(ye,[["__scopeId","data-v-88529481"]]),De=N({__name:"EventsView",setup(G){const f=K(),g=p("General"),m=A(()=>{let n=[];if(g.value=="General")for(const o in c)c[o].GoogleCalendar&&n.push(c[o].GoogleCalendar);else for(const o in c)["General",g.value].includes(c[o].path.substring(1))&&n.push(c[o].GoogleCalendar);return n});return _(()=>f.path,n=>{const o=n.substring(1).split("/");g.value=o[0]},{immediate:!0}),(n,o)=>(r(),X(_e,{calendarID:m.value},null,8,["calendarID"]))}});export{De as default};
