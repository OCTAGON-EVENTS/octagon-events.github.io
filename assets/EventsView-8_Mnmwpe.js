import{d as O,i as q,j as v,e as G,w as _,o as r,c as i,F as x,r as L,b as s,k as C,l as P,t as l,m as p,p as d,s as R,_ as $,h as F,g as J}from"./index-DKHA5VwW.js";const Q={key:0,class:"main"},z={class:"card"},X={class:"wrapper"},K={class:"dateDisplay"},Y={class:"eventDay"},Z={class:"eventMonth"},tt={class:"eventTime"},et={class:"eventTimeOfDay"},at={class:"dateDisplay"},st={class:"eventDay"},nt={class:"eventMonth"},ot={class:"eventTime"},rt={class:"eventTimeOfDay"},it={key:0},lt={key:0},ct=["src"],dt=["innerHTML"],ut={key:3},gt={key:1,class:"empty"},k="-",mt=O({__name:"GoogleCalendar",props:{calendarID:{type:Array,required:!1}},setup(w){P(a=>({b82d9de6:g.value}));const f=q("branch",v("General")),g=G(()=>"var("+d[f.value].color+")"),m=w,n=v(null),o=v();function B(){for(const a in m.calendarID){const e=new XMLHttpRequest;e.onreadystatechange=function(){this.readyState==4&&this.status==200&&(n.value?n.value=n.value.concat(JSON.parse(this.responseText).items):n.value=JSON.parse(this.responseText).items)},e.open("GET",`https://www.googleapis.com/calendar/v3/calendars/${m.calendarID[a]}/events?key=AIzaSyC7fs2QT_Hb9Q3Tn5_7bhLcOISwqsgLyg4&maxResults=16&orderBy=startTime&singleEvents=true&timeMin=${new Date().toISOString()}`,!0),e.send()}}const u=v([]);return _(()=>m.calendarID,()=>{n.value=null,B()},{immediate:!0}),_(n,()=>{u.value=[];const a=n.value;for(const e in a){const t=a[e].summary;if(t.startsWith("?")&&!R.Tools.display)continue;const y=a[e].location,c=new Date(a[e].start.dateTime),h=new Date(a[e].end.dateTime),D=c.getDate(),M=String(D).length==1?"0"+String(D):D,N=String(c).split(" ")[1].toUpperCase(),T=c.toLocaleTimeString(navigator.language,{hour:"2-digit",minute:"2-digit"}).split(" "),A=T[0],E=T.length>1?T[1]:"",S=h.getDate(),U=String(S).length==1?"0"+String(S):S,V=String(h).split(" ")[1].toUpperCase(),b=h.toLocaleTimeString(navigator.language,{hour:"2-digit",minute:"2-digit"}).split(" "),j=b[0],H=b.length>1?b[1]:"";let I=null;Object.keys(a[e]).includes("attachments")&&(I="https://drive.google.com/thumbnail?id="+a[e].attachments[0].fileId);const W=a[e].description;u.value.push({start:{day:M,month:N,time:A,timeOfDay:E,startDateTime:c},end:{day:U,month:V,time:j,timeOfDay:H},summary:t,location:y,imageUrl:I,description:W})}u.value.length&&u.value.sort((e,t)=>{const y=new Date(e.start.startDateTime),c=new Date(t.start.startDateTime);return y-c})}),_(o,()=>{for(const a in o.value)for(const e in o.value[a].getElementsByTagName("a"))try{o.value[a].getElementsByTagName("a")[e].setAttribute("target","_blank")}catch{continue}}),(a,e)=>(r(),i("main",null,[u.value.length?(r(),i("div",Q,[(r(!0),i(x,null,L(u.value,(t,y)=>(r(),i("div",z,[s("div",X,[s("div",K,[s("div",Y,l(t.start.day),1),s("div",Z,l(t.start.month),1),s("div",tt,l(t.start.time),1),s("div",et,l(t.start.timeOfDay),1)]),e[0]||(e[0]=s("div",{class:"dateDisplay"},"TILL",-1)),s("div",at,[s("div",st,l(t.end.day),1),s("div",nt,l(t.end.month),1),s("div",ot,l(t.end.time),1),s("div",rt,l(t.end.timeOfDay),1)])]),s("div",{ref_for:!0,ref_key:"content",ref:o,class:"content",style:{padding:"15px"}},[String(t.summary).startsWith(k)?p("",!0):(r(),i("div",it,[(r(!0),i(x,null,L(t.summary.split("\\n"),(c,h)=>(r(),i("b",null,[C(l(c),1),h!=t.summary.split("\\n").length?(r(),i("br",lt)):p("",!0)]))),256))])),t.imageUrl?(r(),i("img",{key:1,class:"googleDriveImage",src:t.imageUrl},null,8,ct)):p("",!0),t.description&&!String(t.description).startsWith(k)?(r(),i("div",{key:2,innerHTML:t.description,class:"googleCalendarDescription"},null,8,dt)):p("",!0),t.location&&!String(t.location).startsWith(k)?(r(),i("div",ut,"Location: "+l(t.location),1)):p("",!0)],512)]))),256))])):(r(),i("div",gt,e[1]||(e[1]=[s("h1",null,[C("Pretty empty right now."),s("br"),C("Maybe next time?")],-1)])))]))}}),ht=$(mt,[["__scopeId","data-v-f0bf84b6"]]),vt=O({__name:"EventsView",setup(w){const f=J(),g=v("General"),m=G(()=>{let n=[];if(g.value=="General")for(const o in d)d[o].GoogleCalendar&&n.push(d[o].GoogleCalendar);else for(const o in d)["General",g.value].includes(d[o].path.substring(1))&&n.push(d[o].GoogleCalendar);return n});return _(()=>f.path,n=>{const o=n.substring(1).split("/");g.value=o[0]},{immediate:!0}),(n,o)=>(r(),F(ht,{calendarID:m.value},null,8,["calendarID"]))}});export{vt as default};
